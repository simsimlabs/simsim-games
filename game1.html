<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì„¸í¬ í‚¤ìš°ê¸° - ì‹¬ì‹¬í’€ì´ ê²Œì„ ì—°êµ¬ì†Œ</title>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2261846676525942" crossorigin="anonymous"></script>
    
    <link rel="canonical" href="https://simsimlabs.com/simsim-games/game1.html">

    <meta name="description" content="ì„¸í¬ í‚¤ìš°ê¸°(Cell Eaters) ì›¹ê²Œì„. ì‘ì€ ì„¸í¬ë¡œ ì‹œì‘í•´ ì ì„ í”¼í•˜ê³  ë¨¹ì´ë¥¼ ë¨¹ì–´ ê±°ëŒ€í•˜ê²Œ ì„±ì¥í•˜ì„¸ìš”. ì„¤ì¹˜ ì—†ëŠ” ë¬´ë£Œ ì„œë°”ì´ë²Œ ê²Œì„.">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="ğŸ¦  ì„¸í¬ í‚¤ìš°ê¸° - ì‹¬ì‹¬í’€ì´ ê²Œì„ ì—°êµ¬ì†Œ">
    <meta property="og:description" content="ë‚˜ë³´ë‹¤ ì‘ì€ ì„¸í¬ë¥¼ ë¨¹ê³  ê±°ëŒ€í•´ì§€ì„¸ìš”! ì ì„ í”¼í•˜ê³  ìµœí›„ì˜ ìƒì¡´ìê°€ ë˜ëŠ” ì‹¤ì‹œê°„ ì„œë°”ì´ë²Œ ê²Œì„.">
    <meta property="og:image" content="https://simsimlabs.com/simsim-games/thumbnail.png">
    <meta property="og:url" content="https://simsimlabs.com/simsim-games/game1.html">

    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* 1. ê¸°ë³¸ ë ˆì´ì•„ì›ƒ (ì• ë“œì„¼ìŠ¤ ì¹œí™”ì  êµ¬ì¡°) */
        body { 
            margin: 0; padding: 0; 
            background-color: #f0f2f5; 
            font-family: 'Noto Sans KR', sans-serif;
            color: #333;
            overflow-x: hidden; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        }

        header {
            background: #2d3436; color: white; padding: 15px 20px; text-align: center;
        }

        .header-top {
            display: flex; justify-content: space-between; max-width: 1000px; margin: 0 auto 10px; font-size: 0.9rem;
        }
        .header-top a { color: #dfe6e9; text-decoration: none; }

        h1 { margin: 0; font-family: 'Jua', sans-serif; font-size: 1.8rem; }

        /* 2. ê´‘ê³  ì˜ì—­ (ì˜¤í´ë¦­ ë°©ì§€ ì—¬ë°±) */
        .ad-banner {
            width: 100%; max-width: 1000px; margin: 20px auto;
            text-align: center; background: #fff; padding: 10px 0;
            border-radius: 8px; overflow: hidden;
        }

        /* 3. ê²Œì„ ì»¨í…Œì´ë„ˆ (ë°˜ì‘í˜• ë°•ìŠ¤) */
        #game-container-box {
            position: relative;
            width: 100%; max-width: 900px; /* PC ìµœëŒ€ ë„ˆë¹„ */
            height: 600px; /* PC ê¸°ë³¸ ë†’ì´ */
            margin: 0 auto;
            background-color: #000; border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            touch-action: none; /* ê²Œì„ ë‚´ í„°ì¹˜ ì‹œ í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            user-select: none;
            -webkit-user-select: none;
        }

        canvas { display: block; width: 100%; height: 100%; cursor: crosshair; }

        /* 4. UI ë ˆì´ì–´ (ì‹œì‘ í™”ë©´, ê²Œì„ì˜¤ë²„) */
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; color: white; text-align: center;
        }

        #ui-layer h2 { font-family: 'Jua', sans-serif; font-size: 3rem; color: #6c5ce7; margin-bottom: 10px; text-shadow: 2px 2px 0 #fff; }
        #ui-layer p { font-size: 1.1rem; color: #dfe6e9; margin-bottom: 30px; line-height: 1.6; }
        
        #start-btn {
            background: #ff7675; color: white; border: none; padding: 15px 50px;
            font-size: 1.5rem; font-family: 'Jua', sans-serif; border-radius: 50px;
            cursor: pointer; box-shadow: 0 5px 0 #d63031; transition: transform 0.1s;
        }
        #start-btn:active { transform: translateY(4px); box-shadow: none; }
        #start-btn:hover { background: #ff6b6b; }

        /* 5. ì¸ê²Œì„ HUD */
        #leaderboard {
            position: absolute; top: 15px; right: 15px;
            background: rgba(0,0,0,0.5); color: white; padding: 12px;
            border-radius: 8px; font-family: 'Jua', sans-serif; font-size: 0.95rem;
            min-width: 140px; pointer-events: none; z-index: 50;
        }
        #rank-list { list-style: none; padding: 0; margin: 0; }
        #rank-list li { margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.2); }

        #kill-log {
            position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(214, 48, 49, 0.9); color: white;
            padding: 8px 25px; border-radius: 20px; font-weight: bold;
            opacity: 0; transition: opacity 0.3s; pointer-events: none; z-index: 50;
            white-space: nowrap;
        }

        /* 6. ëª¨ë°”ì¼ ì¡°ì´ìŠ¤í‹± */
        #joystick-zone {
            position: absolute; bottom: 30px; left: 30px; width: 120px; height: 120px;
            z-index: 90; display: none; /* JSë¡œ ëª¨ë°”ì¼ì—ì„œë§Œ ì¼œì§ */
        }
        #joystick-bg {
            width: 100%; height: 100%; background: rgba(255, 255, 255, 0.15);
            border-radius: 50%; position: relative; border: 2px solid rgba(255,255,255,0.3);
        }
        #joystick-stick {
            width: 50px; height: 50px; background: rgba(255, 255, 255, 0.8);
            border-radius: 50%; position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        /* 7. ì½˜í…ì¸  ì„¤ëª…ê¸€ (ì• ë“œì„¼ìŠ¤ìš© ë¸”ë¡œê·¸ ìŠ¤íƒ€ì¼) */
        .content-article {
            max-width: 900px; margin: 40px auto; padding: 30px;
            background: #fff; border-radius: 12px; line-height: 1.8;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .content-article h2 { color: #ff7675; border-bottom: 2px solid #f1f2f6; padding-bottom: 10px; margin-top: 30px; }
        .content-article h3 { color: #74b9ff; margin-top: 25px; }
        .content-article ul { background: #f8f9fa; padding: 20px 40px; border-radius: 8px; }

        /* 8. ê³µìœ  ë²„íŠ¼ & í† ìŠ¤íŠ¸ */
        .share-bar { text-align: center; margin: 30px 0; }
        .share-btn {
            background: #333; color: white; border: none; padding: 10px 20px;
            border-radius: 30px; cursor: pointer; font-size: 1rem; margin: 0 5px;
            transition: 0.2s;
        }
        .share-btn:hover { transform: translateY(-2px); }
        .share-btn.copy { background: #6c5ce7; }
        
        #toast {
            visibility: hidden; min-width: 250px; margin-left: -125px;
            background-color: #333; color: #fff; text-align: center;
            border-radius: 2px; padding: 16px; position: fixed; z-index: 1000;
            left: 50%; bottom: 30px; font-size: 17px; opacity: 0; transition: 0.5s;
        }
        #toast.show { visibility: visible; opacity: 1; bottom: 50px; }

        footer { text-align: center; padding: 30px; color: #b2bec3; font-size: 0.9rem; }

        /* ëª¨ë°”ì¼ ìµœì í™” ë¯¸ë””ì–´ ì¿¼ë¦¬ */
        @media (max-width: 800px) {
            #game-container-box {
                width: 100%;
                height: 80vh; /* í™”ë©´ ë†’ì´ì˜ 80%ë¥¼ ê½‰ ì±„ì›€ */
                border-radius: 0;
            }
            #ui-layer h2 { font-size: 2.2rem; }
            .content-article { margin: 20px 10px; padding: 20px; }
            h1 { font-size: 1.4rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-top">
            <a href="en/game1.html">ğŸ‡ºğŸ‡¸ English</a>
            <a href="index.html">ğŸ  ê²Œì„ ëª©ë¡ìœ¼ë¡œ</a>
        </div>
        <h1>ğŸ¦  ì„¸í¬ í‚¤ìš°ê¸°</h1>
    </header>

    <div class="ad-banner">
        <span style="font-size:10px; color:#ccc;">Sponsored</span>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-2261846676525942"
             data-ad-slot="4380369066"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div id="game-container-box">
        <canvas id="gameCanvas"></canvas>

        <div id="leaderboard">
            <h3>ğŸ† TOP 5</h3>
            <ul id="rank-list"><li>Loading...</li></ul>
        </div>

        <div id="kill-log"></div>

        <div id="joystick-zone">
            <div id="joystick-bg">
                <div id="joystick-stick"></div>
            </div>
        </div>

        <div id="ui-layer">
            <h2 id="ui-title">Cell Eaters</h2>
            <p id="ui-desc">
                ë§ˆìš°ìŠ¤ ë˜ëŠ” í„°ì¹˜ë¡œ ì´ë™í•˜ì—¬ ë¨¹ì´ë¥¼ ë¨¹ìœ¼ì„¸ìš”.<br>
                ë‚˜ë³´ë‹¤ í° ì„¸í¬ëŠ” í”¼í•´ì•¼ í•©ë‹ˆë‹¤!
            </p>
            <button id="start-btn">ê²Œì„ ì‹œì‘ â–¶</button>
        </div>
    </div>
    <div class="ad-banner">
        <span style="font-size:10px; color:#ccc;">Sponsored</span>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-2261846676525942"
             data-ad-slot="4380369066"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div class="share-bar">
        <button class="share-btn copy" onclick="copyLink()"><i class="fa-solid fa-link"></i> ì¹œêµ¬ì™€ ë§í¬ ê³µìœ </button>
    </div>
    <div id="toast">ğŸ“‹ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>

    <article class="content-article">
        <h2>ğŸ® ì„¸í¬ í‚¤ìš°ê¸° (Cell Eaters) ê³µëµ ê°€ì´ë“œ</h2>
        <p>
            ì„¸í¬ í‚¤ìš°ê¸°ëŠ” ì „ ì„¸ê³„ì ìœ¼ë¡œ ì‚¬ë‘ë°›ëŠ” 'Agar.io' ìŠ¤íƒ€ì¼ì˜ <strong>ì‹¤ì‹œê°„ ì„œë°”ì´ë²Œ IO ê²Œì„</strong>ì…ë‹ˆë‹¤.
            í”Œë ˆì´ì–´ëŠ” í•˜ë‚˜ì˜ ì‘ì€ ì„¸í¬ë¡œ ì‹œì‘í•˜ì—¬, ë§µì— í©ì–´ì§„ ë¨¹ì´ë¥¼ ì„­ì·¨í•˜ê³  ë‹¤ë¥¸ í”Œë ˆì´ì–´ë¥¼ ì¡ì•„ë¨¹ìœ¼ë©° í¬ê¸°ë¥¼ í‚¤ì›Œë‚˜ê°€ì•¼ í•©ë‹ˆë‹¤.
            ì„¤ì¹˜ ì—†ì´ ì›¹ì—ì„œ ë°”ë¡œ ì¦ê¸¸ ìˆ˜ ìˆìœ¼ë©°, ë‹¨ìˆœí•œ ê·œì¹™ ì†ì— ê³ ë„ì˜ ì‹¬ë¦¬ì „ì´ ìˆ¨ì–´ ìˆìŠµë‹ˆë‹¤.
        </p>

        <h3>ğŸ•¹ï¸ ì¡°ì‘ ë°©ë²•</h3>
        <ul>
            <li><strong>PC:</strong> ë§ˆìš°ìŠ¤ ì»¤ì„œê°€ ê°€ë¦¬í‚¤ëŠ” ë°©í–¥ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.</li>
            <li><strong>ëª¨ë°”ì¼:</strong> í™”ë©´ ì¢Œì¸¡ í•˜ë‹¨ì˜ ê°€ìƒ ì¡°ì´ìŠ¤í‹±ì„ ë“œë˜ê·¸í•˜ì—¬ ì´ë™í•©ë‹ˆë‹¤.</li>
            <li><strong>ê·œì¹™:</strong> ë‚˜ë³´ë‹¤ ì‘ì€ ì„¸í¬ëŠ” ë¨¹ì„ ìˆ˜ ìˆì§€ë§Œ, í° ì„¸í¬ì—ê²ŒëŠ” ì¡ì•„ë¨¹í™ë‹ˆë‹¤.</li>
        </ul>

        <h3>ğŸ† ê³ ë“ì  ë¹„ë²•</h3>
        <p>
            1. <strong>ì´ˆë°˜ ìƒì¡´:</strong> ê²Œì„ ì‹œì‘ ì§í›„ì—ëŠ” ë¬´ë¦¬í•˜ê²Œ ì‚¬ëƒ¥í•˜ì§€ ë§ˆì„¸ìš”. ë§µì— í©ì–´ì§„ ì‘ì€ ë¨¹ì´(ì )ë¥¼ ë¨¹ìœ¼ë©° ì•ˆì „í•˜ê²Œ ì‚¬ì´ì¦ˆë¥¼ 100 ì´ìƒìœ¼ë¡œ í‚¤ìš°ëŠ” ê²ƒì´ ìš°ì„ ì…ë‹ˆë‹¤.<br><br>
            2. <strong>êµ¬ì„ í™œìš©:</strong> ë§µì˜ ê°€ì¥ìë¦¬ëŠ” ìœ„í—˜í•  ìˆ˜ë„ ìˆì§€ë§Œ, ë“±ì„ ë²½ì— ëŒ€ê³  ì‹¸ìš°ë©´ ì ì´ ê³µê²©í•  ìˆ˜ ìˆëŠ” ê°ë„ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>
            3. <strong>ë¬´ë¦¬í•œ ì¶”ê²© ê¸ˆì§€:</strong> ìì‹ ë³´ë‹¤ ì•„ì£¼ ì¡°ê¸ˆ ì‘ì€ ì ì„ ì«“ì•„ê°€ë©´ ì†ë„ê°€ ë¹„ìŠ·í•´ ì¡ê¸° í˜ë“­ë‹ˆë‹¤. í™•ì‹¤í•˜ê²Œ ì‘ì€ ì ì´ë‚˜ ë¶€ì£¼ì˜í•œ ì ì„ ë…¸ë¦¬ì„¸ìš”.
        </p>
    </article>

    <footer>
        <p>Â© 2024 SimSim Game Labs. All rights reserved.</p>
        <a href="https://simsimlabs.com/privacy.html" style="color:#b2bec3; text-decoration:none;">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
    </footer>

    <script>
        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('game-container-box');
        
        const uiLayer = document.getElementById('ui-layer');
        const uiTitle = document.getElementById('ui-title');
        const uiDesc = document.getElementById('ui-desc');
        const startBtn = document.getElementById('start-btn');
        
        const rankList = document.getElementById('rank-list');
        const killLog = document.getElementById('kill-log');
        
        const joystickZone = document.getElementById('joystick-zone');
        const joystickStick = document.getElementById('joystick-stick');

        // ê²Œì„ ì„¤ì • ë³€ìˆ˜
        const MAP_SIZE = 4000; 
        const BOT_COUNT = 60;
        const FOOD_COUNT = 1500;

        let player = { x: 0, y: 0, r: 0, color: '', name: '' };
        let foods = [];
        let bots = [];
        let gameRunning = false;
        let animationFrameId;

        // ì…ë ¥ ë³€ìˆ˜
        let inputType = 'mouse';
        let mouseX = 0, mouseY = 0;
        let joystickVector = { x: 0, y: 0 };

        // ë´‡ ì´ë¦„ ìƒì„±ê¸° (ë‹¤ì–‘í™”)
        const adjectives = ["ë°°ê³ í”ˆ", "ì¡¸ë¦°", "í–‰ë³µí•œ", "í™”ë‚œ", "ë¹ ë¥¸", "ëŠë¦°", "ê°•ë ¥í•œ", "ê·€ì—¬ìš´", "ë¬´ì„œìš´", "ì‹¬ì‹¬í•œ", "ì¦ê±°ìš´", "ìš©ê°í•œ", "ì†Œì‹¬í•œ", "ë¯¸ì¹œ", "ìˆ¨ì€", "ì „ì„¤ì˜", "ê²Œìœ¼ë¥¸", "ë¶€ì§€ëŸ°í•œ", "ë”ëŸ¬ìš´", "ê¹¨ë—í•œ", "ê±°ëŒ€í•œ", "ìˆ˜ìƒí•œ", "ì²œì¬", "ë°”ë³´"];
        const nouns = ["ì‚¬ëŒ", "ê³ ì–‘ì´", "ê°•ì•„ì§€", "ê°œë°œì", "í•™ìƒ", "ì§ì¥ì¸", "ì§€ë ì´", "ì„¸í¬", "í˜¸ë‘ì´", "ì‚¬ì", "í† ë¼", "ë‹¤ëŒì¥", "ê³°", "ì¹˜í‚¨", "í”¼ì", "í–„ë²„ê±°", "ë¼ë©´", "ê¹€ì¹˜", "ê²Œì´ë¨¸", "ê³µë£¡", "ìŠ¬ë¼ì„", "ì™¸ê³„ì¸", "íˆì–´ë¡œ", "ë¡œë´‡"];

        function generateBotName() {
            return adjectives[Math.floor(Math.random() * adjectives.length)] + " " + nouns[Math.floor(Math.random() * nouns.length)];
        }

        // ì´ˆê¸°í™”
        function init() {
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // ëª¨ë°”ì¼ ê°ì§€í•˜ì—¬ ì¡°ì´ìŠ¤í‹± í‘œì‹œ
            if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                joystickZone.style.display = 'block';
                inputType = 'joystick';
            }

            // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ (ì»¨í…Œì´ë„ˆ ê¸°ì¤€ ì¢Œí‘œ ê³„ì‚°)
            container.addEventListener('mousemove', e => {
                if(inputType !== 'joystick') {
                    const rect = canvas.getBoundingClientRect();
                    // ìº”ë²„ìŠ¤ ìŠ¤ì¼€ì¼ë§ ë¹„ìœ¨ ê³„ì‚° (ë°˜ì‘í˜• ëŒ€ì‘)
                    const scaleX = canvas.width / rect.width;
                    const scaleY = canvas.height / rect.height;
                    mouseX = (e.clientX - rect.left) * scaleX;
                    mouseY = (e.clientY - rect.top) * scaleY;
                }
            });

            container.addEventListener('mousedown', () => { 
                if(!('ontouchstart' in window)) inputType = 'mouse'; 
            });

            startBtn.addEventListener('click', startGame);
            initJoystick();
        }

        function resizeCanvas() {
            // ìº”ë²„ìŠ¤ í•´ìƒë„ ìµœì í™” (ë ˆí‹°ë‚˜ ë””ìŠ¤í”Œë ˆì´ ê³ ë ¤ ë“±ì€ ì„±ëŠ¥ìƒ 1:1ë¡œ ì„¤ì •)
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }

        function startGame() {
            uiLayer.style.display = 'none';
            gameRunning = true;
            
            // ê²Œì„ ë°ì´í„° ì´ˆê¸°í™”
            player = { x: MAP_SIZE/2, y: MAP_SIZE/2, r: 30, color: '#6c5ce7', name: 'ë‚˜ (Player)' };
            foods = [];
            bots = [];
            
            for(let i=0; i<FOOD_COUNT; i++) addFood();
            for(let i=0; i<BOT_COUNT; i++) addBot();
            
            // ì…ë ¥ ì´ˆê¸°í™”
            mouseX = canvas.width / 2;
            mouseY = canvas.height / 2;
            joystickVector = { x: 0, y: 0 };

            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            loop();
        }

        function addFood() {
            foods.push({
                x: Math.random() * MAP_SIZE,
                y: Math.random() * MAP_SIZE,
                r: Math.random() * 5 + 3,
                color: `hsl(${Math.random()*360}, 80%, 70%)`
            });
        }

        function addBot() {
            bots.push({
                x: Math.random() * MAP_SIZE,
                y: Math.random() * MAP_SIZE,
                r: Math.random() * 40 + 20,
                color: `hsl(${Math.random()*360}, 60%, 50%)`,
                name: generateBotName(),
                state: 'wander', // wander, chase, flee
                target: null,
                changeDirTimer: 0,
                angle: Math.random() * Math.PI * 2
            });
        }

        // ì¡°ì´ìŠ¤í‹± ë¡œì§
        function initJoystick() {
            let stick = joystickStick;
            let zone = joystickZone;
            let maxDist = 35; 
            let active = false;
            
            const handleStart = (clientX, clientY) => {
                active = true; inputType = 'joystick';
                const rect = zone.getBoundingClientRect();
                updateStick(clientX, clientY, rect.left + rect.width/2, rect.top + rect.height/2);
            };

            const handleMove = (clientX, clientY) => {
                if(!active) return;
                const rect = zone.getBoundingClientRect();
                updateStick(clientX, clientY, rect.left + rect.width/2, rect.top + rect.height/2);
            };

            const handleEnd = () => {
                active = false;
                stick.style.transform = `translate(-50%, -50%)`;
                joystickVector = { x: 0, y: 0 };
            };

            zone.addEventListener('touchstart', e => { e.preventDefault(); handleStart(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
            zone.addEventListener('touchmove', e => { e.preventDefault(); handleMove(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
            zone.addEventListener('touchend', e => { e.preventDefault(); handleEnd(); });

            function updateStick(clientX, clientY, centerX, centerY) {
                let dx = clientX - centerX;
                let dy = clientY - centerY;
                let dist = Math.sqrt(dx*dx + dy*dy);
                
                if(dist > maxDist) {
                    dx = (dx / dist) * maxDist;
                    dy = (dy / dist) * maxDist;
                }
                
                stick.style.transform = `translate(calc(-50% + ${dx}px), calc(-50% + ${dy}px))`;
                joystickVector = { x: dx / maxDist, y: dy / maxDist };
            }
        }

        // ğŸ¤– ìŠ¤ë§ˆíŠ¸ ë´‡ AI ë¡œì§
        function updateBotAI(b) {
            b.changeDirTimer--;

            // 1. ì£¼ë³€ íƒìƒ‰ (ë‚˜ë³´ë‹¤ í¬ê±°ë‚˜ ì‘ì€ ì•  ì°¾ê¸°)
            let threat = null; // ë‚˜ë³´ë‹¤ ì»¤ì„œ í”¼í•´ì•¼ í•  ëŒ€ìƒ
            let prey = null;   // ë‚˜ë³´ë‹¤ ì‘ì•„ì„œ ë¨¹ì„ ëŒ€ìƒ
            let minDistPrey = Infinity;
            let minDistThreat = Infinity;
            const viewRange = 500 + b.r * 2; // ì‹œì•¼ ë²”ìœ„

            // í”Œë ˆì´ì–´ í™•ì¸
            let dToPlayer = Math.hypot(b.x - player.x, b.y - player.y);
            if (dToPlayer < viewRange) {
                if (player.r > b.r * 1.1) {
                    threat = player;
                    minDistThreat = dToPlayer;
                } else if (player.r < b.r * 0.9) {
                    prey = player;
                    minDistPrey = dToPlayer;
                }
            }

            // ë‹¤ë¥¸ ë´‡ í™•ì¸ (ì„±ëŠ¥ìƒ ì¼ë¶€ë§Œ ì²´í¬í•˜ê±°ë‚˜ ì „ì²´ ì²´í¬)
            // ê°„ë‹¨í•˜ê²ŒëŠ” ë¬´ì‹œí•˜ê³  í”Œë ˆì´ì–´ ìœ„ì£¼ë¡œ ë°˜ì‘í•˜ê±°ë‚˜,
            // ì „ì²´ ë´‡ ë£¨í”„ ëŒë©´ ë¬´ê±°ìš°ë‹ˆ ëœë¤í•˜ê²Œ ëª‡ ëª…ë§Œ ì²´í¬í•˜ê±°ë‚˜ ê°€ê¹Œìš´ ì• ë§Œ ì²´í¬í•´ì•¼ í•¨.
            // ì—¬ê¸°ì„  ê°„ë‹¨íˆ í”Œë ˆì´ì–´ë§Œ ì‹ ê²½ì“°ë˜, ì£¼ê¸°ì ìœ¼ë¡œ ëœë¤ ë°©í–¥ ì „í™˜

            // 2. ìƒíƒœ ê²°ì •
            if (threat) {
                // ë„ë§ê°€ê¸° (Flee)
                b.state = 'flee';
                b.angle = Math.atan2(b.y - threat.y, b.x - threat.x); // ë°˜ëŒ€ ë°©í–¥
            } else if (prey) {
                // ì«“ì•„ê°€ê¸° (Chase)
                b.state = 'chase';
                b.angle = Math.atan2(prey.y - b.y, prey.x - b.x);
            } else {
                // ë°°íšŒí•˜ê¸° (Wander)
                b.state = 'wander';
                if (b.changeDirTimer <= 0) {
                    b.changeDirTimer = Math.random() * 50 + 20;
                    b.angle += (Math.random() - 0.5) * 2; // ì•½ê°„ì”© ë°©í–¥ í‹€ê¸°
                    
                    // ë§µ ì¤‘ì•™ìœ¼ë¡œ ëŒì•„ì˜¤ë ¤ëŠ” ê²½í–¥ ì¶”ê°€ (ë²½ì— ë°•í˜€ìˆì§€ ì•Šê²Œ)
                    if (b.x < 100 || b.x > MAP_SIZE - 100 || b.y < 100 || b.y > MAP_SIZE - 100) {
                        b.angle = Math.atan2(MAP_SIZE/2 - b.y, MAP_SIZE/2 - b.x);
                    }
                }
            }
        }

        // ë©”ì¸ ê²Œì„ ë£¨í”„
        function loop() {
            if(!gameRunning) return;

            // ë°°ê²½ ì§€ìš°ê¸°
            ctx.fillStyle = '#f0f2f5';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ì¹´ë©”ë¼ ì´ë™ (í”Œë ˆì´ì–´ê°€ í™”ë©´ ì¤‘ì•™ì— ì˜¤ë„ë¡)
            let zoom = Math.max(0.4, 50 / (player.r + 50)); // ë¶€ë“œëŸ¬ìš´ ì¤Œ
            
            ctx.save();
            ctx.translate(canvas.width/2, canvas.height/2);
            ctx.scale(zoom, zoom);
            ctx.translate(-player.x, -player.y);

            // ê²©ì ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#dfe6e9'; ctx.lineWidth = 2; ctx.beginPath();
            for(let x=0; x<=MAP_SIZE; x+=100) { ctx.moveTo(x,0); ctx.lineTo(x,MAP_SIZE); }
            for(let y=0; y<=MAP_SIZE; y+=100) { ctx.moveTo(0,y); ctx.lineTo(MAP_SIZE,y); }
            ctx.stroke();
            
            // ë§µ ê²½ê³„ì„ 
            ctx.strokeStyle = '#ff7675'; ctx.lineWidth = 10; ctx.strokeRect(0, 0, MAP_SIZE, MAP_SIZE);

            // ë¨¹ì´ ê·¸ë¦¬ê¸° ë° ì¶©ëŒ ì²˜ë¦¬
            for(let i = foods.length - 1; i >= 0; i--) {
                let f = foods[i];
                // í™”ë©´ ë°– ë¨¹ì´ëŠ” ê·¸ë¦¬ì§€ ì•ŠìŒ (ìµœì í™”)
                if(Math.abs(f.x - player.x) > (canvas.width/zoom + 50) || Math.abs(f.y - player.y) > (canvas.height/zoom + 50)) continue;
                
                drawCircle(f.x, f.y, f.r, f.color);
                
                let distSq = (player.x-f.x)**2 + (player.y-f.y)**2;
                if(distSq < (player.r - f.r/2)**2) { 
                    player.r += 0.2; foods.splice(i, 1); addFood();
                }
            }

            // ë´‡ ë¡œì§ ë° ê·¸ë¦¬ê¸°
            bots.forEach((b, i) => {
                // AI ì—…ë°ì´íŠ¸
                updateBotAI(b);
                
                let bSpeed = 2 + (50 / b.r);
                b.x += Math.cos(b.angle) * bSpeed;
                b.y += Math.sin(b.angle) * bSpeed;
                b.x = Math.max(0, Math.min(MAP_SIZE, b.x)); 
                b.y = Math.max(0, Math.min(MAP_SIZE, b.y));

                // í™”ë©´ ì•ˆì— ë“¤ì–´ì˜¤ë©´ ê·¸ë¦¬ê¸°
                if(Math.abs(b.x - player.x) < (canvas.width/zoom + b.r + 50) && 
                   Math.abs(b.y - player.y) < (canvas.height/zoom + b.r + 50)) {
                    
                    drawCircle(b.x, b.y, b.r, b.color);
                    
                    // ë´‡ ì´ë¦„
                    ctx.fillStyle = 'white'; 
                    ctx.font = `bold ${Math.max(10, b.r * 0.4)}px Noto Sans KR`;
                    ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; 
                    ctx.fillText(b.name, b.x, b.y);
                }

                // ë´‡ vs í”Œë ˆì´ì–´ ì¶©ëŒ
                let distSq = (player.x-b.x)**2 + (player.y-b.y)**2;
                if(distSq < (player.r + b.r)**2) {
                    if(player.r > b.r * 1.1) { // í”Œë ˆì´ì–´ê°€ ë´‡ì„ ë¨¹ìŒ
                        player.r += b.r * 0.4; // ì„±ì¥ë¥  ì¦ê°€
                        bots.splice(i, 1); 
                        addBot(); 
                        showKillLog(`ëƒ ëƒ ! ${b.name} ì²˜ì¹˜!`);
                    } else if (b.r > player.r * 1.1) { // ë´‡ì´ í”Œë ˆì´ì–´ë¥¼ ë¨¹ìŒ
                        gameOver(b.name);
                    }
                }
            });

            // í”Œë ˆì´ì–´ ì´ë™ ë¡œì§
            let moveX = 0, moveY = 0;
            if (inputType === 'joystick') {
                moveX = joystickVector.x; 
                moveY = joystickVector.y;
            } else {
                // ë§ˆìš°ìŠ¤ ì¢Œí‘œëŠ” í™”ë©´ ì¤‘ì•™(ìº”ë²„ìŠ¤ w/2, h/2) ê¸°ì¤€
                let dx = mouseX - canvas.width / 2;
                let dy = mouseY - canvas.height / 2;
                let angle = Math.atan2(dy, dx);
                let dist = Math.sqrt(dx*dx + dy*dy);
                if(dist > 10) { moveX = Math.cos(angle); moveY = Math.sin(angle); }
            }

            let pSpeed = 2.5 + (50 / player.r);
            player.x += moveX * pSpeed; 
            player.y += moveY * pSpeed;
            player.x = Math.max(0, Math.min(MAP_SIZE, player.x)); 
            player.y = Math.max(0, Math.min(MAP_SIZE, player.y));

            // í”Œë ˆì´ì–´ ê·¸ë¦¬ê¸°
            drawCircle(player.x, player.y, player.r, player.color);
            ctx.fillStyle = 'white'; 
            ctx.font = `bold ${Math.max(12, player.r * 0.4)}px Noto Sans KR`;
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; 
            ctx.fillText("ë‚˜", player.x, player.y);

            ctx.restore(); // ì¤Œ/ì´ë™ ë³µêµ¬

            updateLeaderboard();
            animationFrameId = requestAnimationFrame(loop);
        }

        function drawCircle(x, y, r, color) {
            ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2);
            ctx.fillStyle = color; ctx.fill();
            ctx.strokeStyle = 'rgba(0,0,0,0.1)'; ctx.lineWidth = 2; ctx.stroke();
        }

        function showKillLog(msg) {
            killLog.innerText = msg; killLog.style.opacity = 1;
            setTimeout(() => { killLog.style.opacity = 0; }, 2000);
        }

        function updateLeaderboard() {
            let all = [...bots, player].sort((a,b) => b.r - a.r);
            let html = '';
            for(let i=0; i<5; i++) {
                if(!all[i]) break;
                let name = all[i].name === 'ë‚˜ (Player)' ? '<span style="color:#fd79a8">ë‚˜</span>' : all[i].name;
                html += `<li>${i+1}. ${name} <small>(${Math.floor(all[i].r)})</small></li>`;
            }
            rankList.innerHTML = html;
        }

        function gameOver(killer) {
            gameRunning = false;
            cancelAnimationFrame(animationFrameId);
            uiLayer.style.display = 'flex';
            document.getElementById('ui-title').innerText = "ğŸ’€ ê²Œì„ ì˜¤ë²„";
            document.getElementById('ui-desc').innerHTML = `<strong style="color:#ff7675">${killer}</strong>ì—ê²Œ ì¡ì•„ë¨¹í˜”ìŠµë‹ˆë‹¤.<br>ìµœì¢… í¬ê¸°: ${Math.floor(player.r)}`;
            startBtn.innerText = "ë‹¤ì‹œ ë„ì „í•˜ê¸° â†º";
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                const toast = document.getElementById("toast");
                toast.className = "show";
                setTimeout(() => toast.className = toast.className.replace("show", ""), 3000);
            });
        }

        // ì‹¤í–‰
        init();

    </script>
</body>
</html>
